$(function(){

	// 班级标签筛选
	$('.label-select .label-select-item').on('click',function(){
		if($(this).hasClass('disabled')){
			return false;
		}else if($(this).parent().hasClass('multiselect')){
			$(this).toggleClass('active');
		}else{
			$(this).addClass('active').siblings().removeClass('active');
		}
	});

	// 统计维度设置增加分数线
	$('.js-gradeset-add').click(function(){
		var $item='<div class="gradeset-item"><a href="javascript:void(0);" class="red gradeset-close"><i class="fa fa-trash"></i></a><input class="input-sm" type="text" placeholder="请输入分数线名称">&nbsp;<select name="" id=""><option value="0">请输入统计方式</option><option value="1">请输入百分比</option><option value="2">请输入名次</option><option value="3">请输入分值</option></select>&nbsp;<input class="input-sm" type="text" placeholder="请输入百分比">&nbsp;<span></span></div>';
		$(this).parent().find('.gradeset-content').append($item);
	});
	$(document).on('click','.gradeset-close',function(){
		$(this).parent().remove();
	});
	$(document).on('change','.gradeset-item select',function(){
		var $value=$(this).find('option:selected').attr('value');
		if($value==1){
			$(this).parent().find('>span').html('% <strong>该比例换算成分数为640分</strong>');
		}else if($value==2){
			$(this).parent().find('>span').html('<strong>该名次换算成分数为640分</strong>');
		}else{
			$(this).parent().find('>span').html('');
		}
	});

	// 新增科目及分数
	// $('.add-exam-btn').click(function(){
	// 	var $exam_item='<div class="widget-box widget-box-lightblue add-exam-item"><div class="widget-header"><select class="form-control"><option value="">请选择考试科目</option></select><span class="widget-toolbar"><a href="#" data-action="close"><i class="ace-icon fa fa-times bigger-130"></i></a></span></div><div class="widget-body"><div class="widget-main padding-12"><div class="filter"><div class="filter-item block no-float"><label class="filter-name"><input name="form-field-radio" type="radio" class="ace"><span class="lbl"> 只设置总分分数</span></label><div class="filter-content"><input type="text" class="form-control" placeholder="请输入试卷总分"></div></div><div class="filter-item block no-float"><label class="filter-name"><input name="form-field-radio" type="radio" class="ace"><span class="lbl"> 分别设置主客观题分数</span></label><div class="filter-content"><input type="text" class="form-control" placeholder="请输入客观题分数"><input type="text" class="form-control" placeholder="请输入主观题分数"></div></div></div></div></div></div>';
	// 	$(this).parent().before($exam_item);
	// });

	// 添加录分人员
	$('.js-switchInputer').click(function(){
		if(this.checked){
			$('.tab-container').show();
		}else{
			$('.tab-container').hide();
		}
	});
	$('.js-addInputerset').on('click',function(){
		var $inputerset_item='<div class="inputerset-item clearfix"><a href="javascript:void(0);" class="inputerset-del red"><i class="fa fa-trash"></i></a><div class="inputerset-item-teacher well"><span></span></div><span class="inputerset-item-icon"><i class="fa fa-minus"></i></span><div class="inputerset-item-classes well"><a href="javascript:void(0);" class="inputerset-addClass js-addInputerClass">&plus;添加班级</a></div></div>'
		$(this).before($inputerset_item);
	});
	$(document).on('click','.js-delInputerClass,.inputerset-del',function(){
		$(this).parent().remove();
	});

	// 弹出框滚动
	function scrollHeight(){
		$(".layer-body:not(.no-scroll)").ace_scroll({
			size: $(window).height()-200
		});
	}
	scrollHeight();

	// 表单添加与删除
	$('.form-box-wrap').on('click','.form-group-add',function(){
		var $form_group_item='<div class="form-group-item">\
									<select class="chosen-select" data-placeholder="学科名称">\
										<option value=""></option>\
										<option value=""></option>\
									</select>\
									<select class="chosen-select" data-placeholder="教师所属部门">\
										<option value=""></option>\
										<option value=""></option>\
									</select>\
									<select class="chosen-select" data-placeholder="任课教师">\
										<option value=""></option>\
										<option value=""></option>\
									</select>\
									<a class="form-group-del red" href="javascript:void(0);"><i class="fa fa-trash"></i></a>\
								</div>';
		$(this).parent().find('.form-box').append($form_group_item);
		selectChosen();
	});
	$('.form-box-wrap').on('click','.form-group-del',function(){
		$(this).parent().remove();
	})

	// 下拉选择框
	function selectChosen(){
		if(!ace.vars['touch']) {
			$('.chosen-select').chosen({
				allow_single_deselect:true
			}); 
			//resize the chosen on window resize

			$(window)
			.off('resize.chosen')
			.on('resize.chosen', function() {
				$('.chosen-select').each(function() {
					 var $this = $(this);
					 $this.next().css({'width': $this.width()});
				})
			}).trigger('resize.chosen');
			//resize chosen on sidebar collapse/expand
			$(document).on('settings.ace.chosen', function(e, event_name, event_val) {
				if(event_name != 'sidebar_collapsed') return;
				$('.chosen-select').each(function() {
					 var $this = $(this);
					 $this.next().css({'width': $this.width()});
				})
			});
		}
	}
	selectChosen();


	// #############提示工具#############
	$('[data-toggle="tooltip"]').tooltip({
		container: 'body',
		trigger: 'hover'
	});
})